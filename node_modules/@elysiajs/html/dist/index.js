import { Elysia } from 'elysia';
import * as D from 'dompurify';
const sanitize = D.sanitize;
import './declaration';
const isHTMLRegex = /<[^>]*>/;
const isHTML = isHTMLRegex.test.bind(isHTMLRegex);
export const html = () => new Elysia({
    name: '@elysiajs/html'
})
    .derive(({ set }) => ({
    sanitize,
    html(value) {
        return new Response(value, {
            headers: {
                'content-type': 'text/html; charset=utf8'
            }
        });
    }
}))
    .onAfterHandle(({ set }, response) => {
    if (typeof response === 'string' && isHTML(response)) {
        set.headers['content-type'] = 'text/html; charset=utf8';
        return new Response(response, set);
    }
});
const { Fragment: F } = require('@kitajs/html');
export const Fragment = F;
export default html;
